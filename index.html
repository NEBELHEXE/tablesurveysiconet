<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tickets Siconet</title>
  <link rel="stylesheet" href="tablesurveysiconet.css"> <!-- tu CSS separado -->

  <script>
  window.addEventListener('DOMContentLoaded', () => {
    const overlay = document.getElementById('loading-overlay');
    const tableBody = document.querySelector('#tickets-table tbody');

    overlay.style.display = 'flex'; // mostrar overlay

    fetch('https://script.google.com/macros/s/AKfycbwFFlLqmW37g7hPORW5-9bTDVkLWqLOZEasb6oYopbed_eTZOFwdjuZxJX7Gnc2HpjS/exec') // <--- reemplaza con tu URL de WebApp
      .then(res => res.json())
      .then(data => {
        const hoy = new Date();
        data.forEach(ticket => {
          const fechaTicket = new Date(ticket.Fecha);
          const diffDias = Math.floor((hoy - fechaTicket) / (1000 * 60 * 60 * 24));

          // Determinar emoji seg√∫n d√≠as
          let estado = 'ü´°';
          if (diffDias >= 0 && diffDias <= 1) estado = 'ü´°';
          else if (diffDias <= 3) estado = 'üòê';
          else if (diffDias <= 7) estado = '‚òπÔ∏è';
          else estado = 'üíÄ';

          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${ticket.Empresa}</td>
            <td>${ticket.Fecha}</td>
            <td>${ticket.ID}</td>
            <td>${ticket.Urgencia}</td>
            <td>${ticket.Descripcion}</td>
            <td>${estado}</td>
          `;
          tableBody.appendChild(tr);
        });
      })
      .catch(err => console.error(err))
      .finally(() => {
        overlay.style.display = 'none'; // ocultar overlay
      });
  });
  </script>
</head>
<body>
  <div class="header">
    <a target="_blank" href="https://ticketsiconet.netlify.app/">
      <img src="https://siconet.com.mx/wp-content/uploads/2016/12/transparente_2-01.png" alt="Siconet Logo">
    </a>
  </div>

  <main>
    <!-- Overlay de carga -->
    <div id="loading-overlay">
      <div class="spinner"></div>
      <div>Cargando datos, por favor espera...</div>
    </div>

    <!-- Tabla de tickets -->
    <table id="tickets-table">
      <thead>
        <tr>
          <th>Empresa</th>
          <th>Fecha</th>
          <th>ID</th>
          <th>Urgencia</th>
          <th>Descripci√≥n</th>
          <th>Estado</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </main>
</body>
</html>




